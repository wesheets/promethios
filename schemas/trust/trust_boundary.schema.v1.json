{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Trust Boundary Schema",
  "description": "Schema for defining trust boundaries within the Promethios system",
  "type": "object",
  "required": [
    "boundary_id",
    "name",
    "description",
    "boundary_type",
    "classification",
    "created_at",
    "updated_at",
    "version",
    "status"
  ],
  "properties": {
    "boundary_id": {
      "type": "string",
      "description": "Unique identifier for the trust boundary",
      "pattern": "^[a-zA-Z0-9_.-]+$"
    },
    "name": {
      "type": "string",
      "description": "Human-readable name for the trust boundary",
      "minLength": 3,
      "maxLength": 100
    },
    "description": {
      "type": "string",
      "description": "Detailed description of the trust boundary",
      "minLength": 10,
      "maxLength": 1000
    },
    "boundary_type": {
      "type": "string",
      "description": "Type of trust boundary",
      "enum": [
        "process",
        "network",
        "data",
        "user",
        "module",
        "governance"
      ]
    },
    "classification": {
      "type": "string",
      "description": "Security classification of the trust boundary",
      "enum": [
        "public",
        "internal",
        "confidential",
        "restricted",
        "critical"
      ]
    },
    "metadata": {
      "type": "object",
      "description": "Additional metadata for the trust boundary",
      "properties": {
        "owner": {
          "type": "string",
          "description": "Owner of the trust boundary"
        },
        "tags": {
          "type": "array",
          "description": "Tags associated with the trust boundary",
          "items": {
            "type": "string"
          }
        },
        "custom_properties": {
          "type": "object",
          "description": "Custom properties for the trust boundary",
          "additionalProperties": true
        }
      }
    },
    "relationships": {
      "type": "array",
      "description": "Relationships with other trust boundaries",
      "items": {
        "type": "object",
        "required": [
          "related_boundary_id",
          "relationship_type"
        ],
        "properties": {
          "related_boundary_id": {
            "type": "string",
            "description": "ID of the related trust boundary"
          },
          "relationship_type": {
            "type": "string",
            "description": "Type of relationship",
            "enum": [
              "contains",
              "contained_by",
              "intersects",
              "adjacent",
              "depends_on",
              "depended_on_by"
            ]
          },
          "description": {
            "type": "string",
            "description": "Description of the relationship"
          }
        }
      }
    },
    "domains": {
      "type": "array",
      "description": "Trust domains associated with this boundary",
      "items": {
        "type": "string",
        "description": "ID of a trust domain"
      }
    },
    "controls": {
      "type": "array",
      "description": "Security controls enforced at this boundary",
      "items": {
        "type": "object",
        "required": [
          "control_id",
          "control_type",
          "implementation_status"
        ],
        "properties": {
          "control_id": {
            "type": "string",
            "description": "Unique identifier for the control"
          },
          "control_type": {
            "type": "string",
            "description": "Type of security control",
            "enum": [
              "authentication",
              "authorization",
              "encryption",
              "validation",
              "monitoring",
              "logging",
              "filtering",
              "rate_limiting",
              "isolation"
            ]
          },
          "implementation_status": {
            "type": "string",
            "description": "Status of control implementation",
            "enum": [
              "planned",
              "in_progress",
              "implemented",
              "verified",
              "deprecated"
            ]
          },
          "description": {
            "type": "string",
            "description": "Description of the control"
          },
          "verification_method": {
            "type": "string",
            "description": "Method used to verify the control"
          }
        }
      }
    },
    "detection_method": {
      "type": "string",
      "description": "Method used to detect this boundary",
      "enum": [
        "manual",
        "automatic",
        "hybrid"
      ]
    },
    "detection_confidence": {
      "type": "number",
      "description": "Confidence level in the boundary detection (0.0 to 1.0)",
      "minimum": 0.0,
      "maximum": 1.0
    },
    "created_at": {
      "type": "string",
      "description": "ISO 8601 timestamp of when the boundary was created",
      "format": "date-time"
    },
    "updated_at": {
      "type": "string",
      "description": "ISO 8601 timestamp of when the boundary was last updated",
      "format": "date-time"
    },
    "version": {
      "type": "string",
      "description": "Version of the boundary definition",
      "pattern": "^\\d+\\.\\d+\\.\\d+$"
    },
    "status": {
      "type": "string",
      "description": "Current status of the trust boundary",
      "enum": [
        "draft",
        "active",
        "deprecated",
        "retired"
      ]
    },
    "attestations": {
      "type": "array",
      "description": "Attestations for this boundary",
      "items": {
        "type": "object",
        "required": [
          "attestation_id",
          "attester_id",
          "timestamp",
          "validity_period"
        ],
        "properties": {
          "attestation_id": {
            "type": "string",
            "description": "Unique identifier for the attestation"
          },
          "attester_id": {
            "type": "string",
            "description": "Identifier of the entity making the attestation"
          },
          "timestamp": {
            "type": "string",
            "description": "ISO 8601 timestamp of when the attestation was made",
            "format": "date-time"
          },
          "validity_period": {
            "type": "object",
            "required": [
              "start",
              "end"
            ],
            "properties": {
              "start": {
                "type": "string",
                "description": "ISO 8601 timestamp of when the attestation becomes valid",
                "format": "date-time"
              },
              "end": {
                "type": "string",
                "description": "ISO 8601 timestamp of when the attestation expires",
                "format": "date-time"
              }
            }
          },
          "claims": {
            "type": "array",
            "description": "Claims made in this attestation",
            "items": {
              "type": "object",
              "required": [
                "claim_id",
                "claim_type",
                "claim_value"
              ],
              "properties": {
                "claim_id": {
                  "type": "string",
                  "description": "Unique identifier for the claim"
                },
                "claim_type": {
                  "type": "string",
                  "description": "Type of claim"
                },
                "claim_value": {
                  "description": "Value of the claim",
                  "oneOf": [
                    {
                      "type": "string"
                    },
                    {
                      "type": "number"
                    },
                    {
                      "type": "boolean"
                    },
                    {
                      "type": "object"
                    }
                  ]
                }
              }
            }
          },
          "signature": {
            "type": "string",
            "description": "Cryptographic signature of the attestation"
          }
        }
      }
    },
    "change_history": {
      "type": "array",
      "description": "History of changes to the boundary",
      "items": {
        "type": "object",
        "required": [
          "change_id",
          "timestamp",
          "actor_id",
          "change_type"
        ],
        "properties": {
          "change_id": {
            "type": "string",
            "description": "Unique identifier for the change"
          },
          "timestamp": {
            "type": "string",
            "description": "ISO 8601 timestamp of when the change occurred",
            "format": "date-time"
          },
          "actor_id": {
            "type": "string",
            "description": "Identifier of the entity making the change"
          },
          "change_type": {
            "type": "string",
            "description": "Type of change",
            "enum": [
              "created",
              "updated",
              "deprecated",
              "retired",
              "control_added",
              "control_updated",
              "control_removed",
              "relationship_added",
              "relationship_updated",
              "relationship_removed"
            ]
          },
          "description": {
            "type": "string",
            "description": "Description of the change"
          },
          "previous_version": {
            "type": "string",
            "description": "Previous version of the boundary definition"
          },
          "new_version": {
            "type": "string",
            "description": "New version of the boundary definition"
          },
          "changes": {
            "type": "object",
            "description": "Specific changes made",
            "additionalProperties": true
          }
        }
      }
    }
  },
  "additionalProperties": false
}
